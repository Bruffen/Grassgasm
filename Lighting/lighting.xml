<?xml version="1.0" ?>
<project name="Lighting" width = "1280" height = "720">
    <assets>
    	<attributes>
			<attribute name="num_samples" data="INT" type="RENDERER" value=100 />
		</attributes>
		
        <scenes>
            <scene name = "Skybox">
                <geometry name = "cube_skybox" type = "BOX" material="mat_skybox"/>
            </scene>
            <scene name = "Axis">
                <geometry name = "axis" type = "AXIS" />
            </scene>
            <scene name = "Sphere">
                <geometry name = "sphere" type = "SPHERE" />
                <TRANSLATE x=0 y=0 z=-1 />
            </scene>
            <scene name = "Plane">
                <geometry name = "plane" type = "SQUARE" />
                <SCALE x=100 y=1 z=100 />
                <TRANSLATE x=0 y=-2 z=0 />
            </scene>
        </scenes>

        <viewports>
            <viewport name="MainViewport">
                <CLEAR_COLOR r="0.6" g="0.8" b="0.7" />
            </viewport>
        </viewports>

        <cameras>
            <camera name="MainCamera" >
                <viewport name="MainViewport" />
                <POSITION x=0 y=0.5 z=7.5 />
                <VIEW x=0.0 y=0.0 z=-1.0 />
                <UP x=0 y=1 z=0 />
                <NEAR value=0.01 />
            </camera>
        </cameras>

        <lights>
            <light name="Sun">
                <DIRECTION x="1.0" y="-1.0" z="-1.0" />
                <COLOR r="0.9" g="0.9" b="0.9" />
            </light>
        </lights>

        <materialLibs>
			<materialLib filename="materials/skybox.mlib" />
            <materialLib filename="materials/postprocess.mlib" />
		</materialLibs>
    </assets>

    <pipelines>
        <pipeline name="Lighting" default="true">
            <pass class="default" name="Pass">
                <scenes>
                    <scene name="Skybox" />
                    <scene name="Axis" />
                    <scene name="Sphere" />
                    <scene name="Plane" />
                </scenes>
                <camera name="MainCamera" />
                <viewport name="MainViewport" />
                <lights>
                    <light name="Sun" />
                </lights>
                <injectionMaps>
					<map toMaterial="mat_skybox">
						<state name="cull" fromLibrary="Lighting#Pass" />
					</map>
				</injectionMaps>
                <materialMaps>
					<map fromMaterial="mat_skybox" 
                         toMaterial="mat_skybox" toLibrary="Lighting#Pass"/>
				</materialMaps>
                <renderTarget name="Source" fromLibrary="PostProcessing" />
            </pass>

            <!-- Post Processing -->

            <pass class="quad" name="PostProcess1">
				<viewport name="MainViewport" />
                <!--texture name="PostProcessing::tex_source" /-->
				<materialMaps>
					<map fromMaterial="__Quad" 
                         toMaterial="mat_brightness" toLibrary="PostProcessing"/>
				</materialMaps>
                <renderTarget name="Brightness" fromLibrary="PostProcessing" />
			</pass>
            <pass class="quad" name="PostProcess2">
                <camera name="MainCamera" />
				<viewport name="MainViewport" />
				<materialMaps>
					<map fromMaterial="__Quad" 
                         toMaterial="mat_radialblur" toLibrary="PostProcessing"/>
				</materialMaps>
			</pass>
        </pipeline>
    </pipelines>

    <!--interface> 
        <window label="God rays"> 
            <var label="Samples number" type="INT" context="RENDERER" component="num_samples" /> 
        </window>  
    </interface-->   
</project>